(function(){var t;var s;var i=3;var c="";var l=[2,2,3,2],g=$("#path_viz").width(),o=276-l[0]-l[2];console.log($("#path_viz").width());var e=d3.time.scale().range([0,g]);var d=d3.scale.linear().range([o/4,0]);var n=d3.scale.category10();var q=d3.svg.area().interpolate("basis").x(function(h){return e(h.x)}).y0(function(h){return o/4}).y1(function(h){return d(h.y)});var f=d3.svg.line().x(function(h){return e(h.x)}).y(function(h){return d(h.y)});var j;d3.layout.categories=function(){function h(){j=d3.select("#path_viz").html("").append("svg").attr("width",g+l[1]+l[3]).attr("height",o+l[0]+l[2]);k(i,c)}h.top2cat=function(m){if(!arguments.length){return s}s=m;return h};h.cat_data=function(m){if(!arguments.length){return t}t=m;return h};h.show=function(){h();return h};h.cat_id=function(m){c=m;return h};h.top_id=function(m){if(!arguments.length){return i}i=m;return h};return h};function k(){var m=b(i,c);if(m.length!=0){j.selectAll(".area").remove();j.selectAll(".title").remove();m.forEach(function(u){u.y_max=d3.max(u,function(v){return v.y})});e.domain([d3.min(m,function(u){return d3.min(u,function(v){return v.x})}),d3.max(m,function(u){return d3.max(u,function(v){return v.x})})]);var h=m.sort(function(v,u){return u.y_max-v.y_max});m=h.slice(0,4);j.selectAll(".area").data(m).enter().append("path").attr("class","area").attr().attr("transform",function(v,u){return"translate(0,"+u*(o/4)+")"}).attr("d",function(u){d.domain([0,u.y_max*1.25]);return q(u)}).style("fill",function(v,u){return n(0)}).style("fill-opacity",function(v,u){return v.y_max/m[0].y_max*3.5}).on("click",function(u){c=u.id;k()});j.selectAll(".title").data(m).enter().append("text").attr("class","title").attr("x",3).attr("dy","0em").text(function(u){return u.title}).attr("transform",function(v,u){return"translate("+(10)+","+(u+0.25)*(o/4)+")"})}else{}}function b(z,w){var v=new Array();var h=r(s[z]["cat_list"],w);var y=s[z]["segments"];for(cat_tmp in h){var A=new Array();var m=0;var B=0;for(m in y){segment=y[m];var u=p(segment,w,cat_tmp);u.x=B;A.push(u);B=B+1}A.title=a(w+cat_tmp);A.id=w+cat_tmp;v.push(A)}return v}function r(h,u){if(u.length>=1){var m=u[0];u=u.slice(1,u.length);return r(h[m].cat,u)}else{return h}}function p(h,w,v){if(w.length>=1){var m=w[0];w=w.slice(1,w.length);return p(h[m].cat,w,v)}else{var u={};if(h[v]==undefined){u.y=0}else{u.y=h[v].weight}return u}}function a(m){var h=m.split("").join(".");if(h.length==1){h=h+"."}return t[h]}})();